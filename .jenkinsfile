
pipeline {
agent any
           tools { 
                        maven 'MAVEN_HOME'
                             
                 }
            
 
          stages {
                stage('Stage 1: Hello Clean Stage 1') {
                   steps {
                             bat 'mvn clean'
                          }
                }
                stage ('Stage 2: Test Stage') { 
                  steps {
                            bat 'mvn test'
                        }
                }
                stage ('Stage 3: My Package') {
                  steps {
                             bat 'mvn package'
                        }
                }
                stage ('Stage 4: My Final Build Stage') { 
                  steps {
                           bat 'mvn install'
                       }
                }
                stage ('Stage Final: Build Success') {
                  steps {
                            echo 'Build Success!'
                        }
                }
             
    

   stage('SonarCloud Analysis') {
           steps{
            script{
                // Run SonarCloud analysis
                def scannerHome = tool name: 'SonarQube', type: 'hudson.plugins.sonar.SonarRunnerInstallation'
                    withSonarQubeEnv('SonarCloud') {
    sh 'sonar-scanner -Dsonar.projectKey=devi-maven_maven-project -Dsonar.sources=C:\\ProgramData\\Jenkins\\.jenkins\\workspace\\devopsmultibranch_Javaproject1\\src\\main\\java\\ltts\\com\\controller -Dsonar.organization=devi-maven -Dsonar.login=1fb7e32b6693e73ae79513ea8d903f3b9548729c -Dsonar.java.runtime=none'
}
            }
            }
        }
}

       post {
	  success{
            emailext attachLog: true, body: '''Hi,
                      The current status of build ${BUILD_STATUS}
 
                        Thanks''', subject: 'Recend Build Status', to: 'edevikalyani@gmail.com'
        }
    
	failure {
		echo 'Build failed!'
emailext body: 'Good news! The build was successful. Check console output at ${env.BUILD_URL}.', subject: 'Build Failed: ${env.JOB_NAME} #${env.BUILD_NUMBER}', to: 'edevikalyani@gmail.com'
	}
    
}

}
